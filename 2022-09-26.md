# Instalación de software libre y propietario

- Funciones de un sistema operativo.
  - Controlar y gestionar el uso del hardware del ordenador: CPU, dispositivos de E/S, Memoria principal, tarjetas gráficas y el resto de periféricos.
  - Administrar la ejecución de los procesos. Planificación.
  - Controlar el proceso de organización de la información. Creación, acceso (ubicación física) y borrado de archivos.
  - Controlar el acceso de los programas o los usuarios a los recursos del sistema.
  - Proporcionar interfaces de usuario: en modo texto y gráficos.
  - Servicios soporte: actualizaciones de software, controladores para nuevos periféricos, etc.

-----------------

# Funciones del sistema operativo:
- Procesos
- Recursos
- Interfaces de usuario

# Ejercicios sencillos

## Ejercicios básicos sobre procesos (qué palabra necesitas: listar, agrupar, seleccionar, abrir, ordenar)
- Listar procesos por propiedades.
- Listar todos los procesos.
- Mostrar los 5 primeros procesos.
- Mostrar los 5 últimos procesos.
- Ordenar todos los procesos por CPU de forma descendente.
- Agrupa los procesos y muestras los que sean svchost.
- Ordena el consumo de CPU de forma descendente.
- Abre 5 notepad, ordena por el consumo de CPU.
- Abre 5 notepad, utiliza y ordena por el consumo de CPU.
- Listar las propiedades cpu y PM.
- Obtener información ampliada sobre procesos.
- Obtener los 5 primeros procesos ordenados.
- Listar los procesos que tengan consumo alto de tiempo de CPU.
- Listar los procesos junto el fabricante.
- Mostrar información sobre el proceso notepad.

------------------

# Ejercicios nivel medio

## Guardar en un fichero la versión de Windows utilizando un cmdlet
* https://www.jesusninoc.com/09/14/guardar-en-un-fichero-la-version-de-windows-utilizando-un-cmdlet/

## Guardar en un fichero la versión del núcleo de Linux utilizando un cmdlet
* https://www.jesusninoc.com/09/14/guardar-en-un-fichero-la-version-del-nucleo-de-linux-wsl-utilizando-un-cmdlet-de-powershell/

## Ejercicio propuesto
### Comparar la ejecución de procesos en dos momentos distintos (arrancar Notepad)
* https://www.jesusninoc.com/07/01/1-introduccion-a-powershell/#Comparar

-------------------

# Ejercicios propuestos

## Juntar dos ficheros con información (fichero con fecha y fichero con procesos que se ejecutan):
* https://www.jesusninoc.com/11/02/ejercicios-de-powershell-juntar-dos-ficheros-con-informacion-fichero-con-fecha-y-fichero-con-procesos-que-se-ejecutan/

## Ejecutar un comando que se encuentra escrito en una cadena:
* https://www.jesusninoc.com/11/03/ejercicios-de-powershell-ejecutar-un-comando-que-se-encuentra-escrito-en-una-cadena/

## Mostrar los procesos con un Where:
* https://www.jesusninoc.com/11/04/ejercicios-de-powershell-mostrar-informacion-sobre-un-proceso-que-se-esta-ejecutando-con-un-where/

## Abrir procesos leyendo desde un fichero (en un fichero aparece el número de veces que se abre el proceso y en otro fichero aparece el nombre del proceso que queremos abrir)
* https://www.jesusninoc.com/11/05/ejercicios-de-powershell-abrir-procesos-leyendo-desde-un-fichero-en-un-fichero-aparece-el-numero-de-veces-que-se-abre-el-proceso-y-en-otro-fichero-aparece-el-nombre-del-proceso-que-queremos-abrir/

## Parar el proceso leyendo desde un fichero el nombre del proceso que vamos a parar (el nombre del proceso que vamos a parar se almacena mediante un Out-File siendo el primer proceso)
* https://www.jesusninoc.com/11/06/ejercicios-de-powershell-parar-el-proceso-leyendo-desde-un-fichero-el-nombre-del-proceso-que-vamos-a-parar-el-nombre-del-proceso-que-vamos-a-parar-se-almacena-mediante-un-out-file-siendo-el-primer-p/

------------------

# Ejercicios básicos sobre procesos en PowerShell (con alias)
* https://www.jesusninoc.com/09/22/ejercicios-de-powershell-ejercicios-basicos-sobre-procesos-en-powershell-con-alias/

-----------

# Ejercicios básicos sobre procesos en Linux
* https://www.jesusninoc.com/03/11/ejercicios-basicos-sobre-procesos-en-linux/

# Ejercicios avanzados
* Convertir 1. Introducción a PowerShell (nivel intermedio) en WSL
* Listar un número de procesos que introduce el usuario y ordenar los procesos por un valor que introduce el usuario
* Listar un número de procesos que introduce el usuario y ordenar los procesos por un valor que introduce el usuario y almacena en un fichero

### Ayuda:
```PowerShell
ps | sort cpu
```
```PowerShell
ps | sort cpu | select -First 5
ps | sort cpu -Descending | select -First 5
```
```PowerShell
ps | select -First 5 | sort cpu
ps | select -First 5 | sort cpu -Descending
```
```PowerShell
ps | select -First (Read-Host) | sort (Read-Host)
ps | select -First (gc numero) | sort (gc buscar)
```
```PowerShell
$guardarnumero = Read-Host "Dime número de procesos a listar"
$guardarnumero | Out-File numerodeprocesos.txt
Get-Content .\numerodeprocesos.txt

$guardarvalor = Read-Host "Dime por qué valor ordenar"
$guardarvalor | Out-File numerodevalores.txt
Get-Content .\numerodevalores.txt

Get-Process | Select-Object -First (Get-Content .\numerodeprocesos.txt) | Sort-Object (Get-Content .\numerodevalores.txt)
```

--------------------
--------------------

# Instalación de software libre y propietario

- Funciones de un sistema operativo.
  - Controlar y gestionar el uso del hardware del ordenador: CPU, dispositivos de E/S, Memoria principal, tarjetas gráficas y el resto de periféricos.
  - Administrar la ejecución de los procesos. Planificación.
  - Controlar el proceso de organización de la información. Creación, acceso (ubicación física) y borrado de archivos.
  - Controlar el acceso de los programas o los usuarios a los recursos del sistema.
  - Proporcionar interfaces de usuario: en modo texto y gráficos.
  - Servicios soporte: actualizaciones de software, controladores para nuevos periféricos, etc.

# Repaso de PowerShell
* https://www.jesusninoc.com/07/01/1-introduccion-a-powershell/

# Ejercicios de repaso
* https://www.jesusninoc.com/09/23/ejercicios-de-powershell-mostrar-los-procesos-ordenados-por-cpu-cuyo-nombre-indica-el-usuario-utilizar-un-fichero-para-almacenar-dicho-nombre/
* https://www.jesusninoc.com/09/23/ejercicios-de-powershell-mostrar-los-procesos-cuyo-nombre-y-tiempo-de-consumo-de-cpu-indica-el-usuario-y-ordenarlos-por-cpu-utilizar-dos-ficheros-para-almacenar-el-nombre-y-el-tiempo-de-consumo/
* https://www.jesusninoc.com/09/23/ejercicios-de-powershell-mostrar-un-numero-de-procesos-por-nombre-que-indica-el-usuario-y-ordenarlos-por-cpu/

-----------------
-----------------

# Instalación de software libre y propietario

- Funciones de un sistema operativo.
  - Controlar y gestionar el uso del hardware del ordenador: CPU, dispositivos de E/S, Memoria principal, tarjetas gráficas y el resto de periféricos.
  - Administrar la ejecución de los procesos. Planificación.
  - Controlar el proceso de organización de la información. Creación, acceso (ubicación física) y borrado de archivos.
  - Controlar el acceso de los programas o los usuarios a los recursos del sistema.
  - Proporcionar interfaces de usuario: en modo texto y gráficos.
  - Servicios soporte: actualizaciones de software, controladores para nuevos periféricos, etc.

# Creación y destrucción de procesos
## Creación de procesos (apartado Crear procesos)
https://www.jesusninoc.com/2017/07/07/7-gestion-de-procesos-en-powershell/
## Destrucción de procesos (apartado Matar procesos)
https://www.jesusninoc.com/2017/07/07/7-gestion-de-procesos-en-powershell/

# Más información sobre procesos
https://www.jesusninoc.com/2017/07/07/7-gestion-de-procesos-en-powershell/

--------------------

# Ejercicio con Base64
## Ejercicio resuelto de CREAR TABLA DE BASE64
https://www.jesusninoc.com/2017/02/11/tabla-de-caracteres-base64/

## EJECUTAR UN START-PROCESS (CREAR UN PROCESO)
```PowerShell
Start-Process -FilePath powershell.exe -ArgumentList '-encodedcommand RwBlAHQALQBQAHIAbwBjAGUAcwBzAA=='
```

## Ejecutar un cmdlet codificado en Base64
https://www.jesusninoc.com/2016/09/24/ejecutar-un-cmdlet-convertido-en-base64/

# Para repasar
- https://github.com/jesnino/PowerShell
- https://github.com/jesnino/PowerShell/tree/master/Repaso
- https://www.jesusninoc.com/2017/07/07/7-gestion-de-procesos-en-powershell/

----------
----------

# Instalación de software libre y propietario

- Funciones de un sistema operativo.
  - Controlar y gestionar el uso del hardware del ordenador: CPU, dispositivos de E/S, Memoria principal, tarjetas gráficas y el resto de periféricos.
  - Administrar la ejecución de los procesos. Planificación.
  - Controlar el proceso de organización de la información. Creación, acceso (ubicación física) y borrado de archivos.
  - Controlar el acceso de los programas o los usuarios a los recursos del sistema.
  - Proporcionar interfaces de usuario: en modo texto y gráficos.
  - Servicios soporte: actualizaciones de software, controladores para nuevos periféricos, etc.

--------------------

# Ejercicios PowerShell hilos y procesos
* https://www.jesusninoc.com/01/01/ejercicios-de-powershell-ejercicios-de-hilos/

## Obtener el nombre de un proceso y el número de hilos de cada proceso
* https://www.jesusninoc.com/09/28/ejercicios-de-powershell-obtener-el-nombre-de-un-proceso-y-el-numero-de-hilos-de-cada-proceso/

## Obtener el identificador del hilo junto con el nombre del proceso que lo creó
* https://www.jesusninoc.com/09/28/ejercicios-de-powershell-obtener-el-identificador-del-hilo-junto-con-el-nombre-del-proceso-que-lo-creo/

## Ejercicios de PowerShell: conocer los procesos padres y abuelos (padres de padres) de todos los hilos que se están ejecutando en el sistema
* https://www.jesusninoc.com/09/28/ejercicios-de-powershell-conocer-los-procesos-padres-y-abuelos-padres-de-padres-de-todos-los-hilos-que-se-estan-ejecutando-en-el-sistema/

## Ejercicios de PowerShell: pedir al usuario un número de hilo y mostrar el nombre del proceso padre que crea el hilo y el abuelo 
* https://www.jesusninoc.com/09/28/ejercicios-de-powershell-pedir-al-usuario-un-numero-de-hilo-y-mostrar-el-nombre-del-proceso-padre-que-crea-el-hilo-y-el-abuelo/

----------------
----------------

# Instalación de software libre y propietario

- Funciones de un sistema operativo.
  - Controlar y gestionar el uso del hardware del ordenador: CPU, dispositivos de E/S, Memoria principal, tarjetas gráficas y el resto de periféricos.
  - Administrar la ejecución de los procesos. Planificación.
  - Controlar el proceso de organización de la información. Creación, acceso (ubicación física) y borrado de archivos.
  - Controlar el acceso de los programas o los usuarios a los recursos del sistema.
  - Proporcionar interfaces de usuario: en modo texto y gráficos.
  - Servicios soporte: actualizaciones de software, controladores para nuevos periféricos, etc.

# Memoria

## Ejercicios PowerShell sobre variables

### Mostrar un char desde un int
```PowerShell
[Int]'A'[0]
```
### Mostrar un int desde un char
```PowerShell
[Char]65
```
### Ejecutar un cmdlet leyendo desde un fichero el cmdlet
```PowerShell
"gps" | Out-File ejecutar.txt
Invoke-Expression (gc .\ejecutar.txt)
```
### Modificar el contenido de un fichero
```PowerShell
1 | Out-File ejemplo1.txt
(gc ejemplo1.txt)+"modificado" | Out-File ejemplo2.txt
gc .\ejemplo2.txt
```
### Modificar el contenido de un fichero (leer un número de un fichero y sumar un número, después almacenar el valor)
* https://www.jesusninoc.com/11/13/ejercicios-de-powershell-modificar-el-contenido-de-un-fichero-leer-un-numero-de-un-fichero-y-sumar-un-numero-despues-almacenar-el-valor/
### Modificar el contenido de un fichero (leer un número de un fichero y restar un número, después almacenar el valor)
* https://www.jesusninoc.com/11/15/ejercicios-de-powershell-modificar-el-contenido-de-un-fichero-utilizando-variables-leer-un-numero-de-un-fichero-y-restar-un-numero-despues-almacenar-el-valor/
### Modificar el contenido de un fichero utilizando variables (leer un número de un fichero y restar un número, después almacenar el valor)
* https://www.jesusninoc.com/11/15/ejercicios-de-powershell-modificar-el-contenido-de-un-fichero-utilizando-variables-leer-un-numero-de-un-fichero-y-restar-un-numero-despues-almacenar-el-valor/
### Listar la mitad de un número de procesos y ordenarlos (el usuario introduce los valores en variables y los almacena en ficheros)
```PowerShell
$first = Read-Host "intro first"
$first | Out-File first.txt

$orden = Read-Host "intro orden"
$orden | Out-File orden.txt
gps | select -First ([Int ]$first / 2) | sort $orden
```

### Guardar un valor aleatorio en un fichero
```PowerShell
(Get-Random (1..5)) | Out-File aleatorio.txt
```

---------------
---------------

# Instalación de software libre y propietario

- Funciones de un sistema operativo.
  - Controlar y gestionar el uso del hardware del ordenador: CPU, dispositivos de E/S, Memoria principal, tarjetas gráficas y el resto de periféricos.
  - Administrar la ejecución de los procesos. Planificación.
  - Controlar el proceso de organización de la información. Creación, acceso (ubicación física) y borrado de archivos.
  - Controlar el acceso de los programas o los usuarios a los recursos del sistema.
  - Proporcionar interfaces de usuario: en modo texto y gráficos.
  - Servicios soporte: actualizaciones de software, controladores para nuevos periféricos, etc.

--------------------

# Ejercicios sobre hilos

## Almacenar información sobre los hilos
* https://www.jesusninoc.com/11/22/ejercicios-de-powershell-almacenar-informacion-sobre-hilos-de-forma-continuada/

## Mostrar información sobre los hilos del proceso Notepad 
* https://www.jesusninoc.com/11/17/ejercicios-de-powershell-mostrar-informacion-sobre-los-hilos-del-proceso-notepad/

## Mostrar información sobre los hilos de todos los procesos que se están ejecutando (qué proceso ejecuta el hilo)
* https://www.jesusninoc.com/11/19/ejercicios-de-powershell-mostrar-informacion-sobre-los-hilos-de-todos-los-procesos-que-se-estan-ejecutando-que-proceso-ejecuta-el-hilo/

## Listar hilos de cada proceso
* https://www.jesusninoc.com/07/22/listar-los-hilos-de-un-proceso/

## Almacenar información sobre hilos de forma continuada
* https://www.jesusninoc.com/11/22/ejercicios-de-powershell-almacenar-informacion-sobre-hilos-de-forma-continuada/

## Mostrar los hilos de cada proceso utilizando WMI y el cmdlet Get-Process
* https://www.jesusninoc.com/11/23/ejercicios-de-powershell-mostrar-los-hilos-de-cada-proceso-utilizando-wmi-y-el-cmdlet-get-process/

## Relación entre servicios y procesos
* https://www.jesusninoc.com/10/11/mostrar-la-relacion-entre-servicios-y-procesos-con-powershell/

## Ayuda de servicios con procesos
```PowerShell
foreach($elementos in (Get-WmiObject -Class Win32_Service))
{
    $elementos
}

Get-WmiObject -Class Win32_Service | %{
Write-Host $_.Name,$_.ProcessID,(Get-Process -Id $_.ProcessID).name
}
```

## Ayuda de procesos WMI con procesos
```PowerShell
Get-WmiObject Win32_Process | %{
    $_.Handles,$_.ProcessHandle,(Get-Process -Id $_.ProcessHandle).ProcessName
}

Get-WmiObject Win32_Process | %{
    (Get-Process -Id $_.ProcessId),$_.ProcessName,$_.Handle,$_.ProcessId
}
```

## Almacenar el número de procesos e hilos en un fichero junto con la fecha (el script se ejecuta cada cinco segundos)
* https://www.jesusninoc.com/11/26/ejercicios-de-powershell-almacenar-el-numero-de-procesos-e-hilos-en-un-fichero-junto-con-la-fecha-el-script-se-ejecuta-cada-cinco-segundos/

# Servicios y relación con procesos
## No funciona porque no puede convertir ProcessID
```PowerShell
Get-WmiObject -Class Win32_Service | Select-Object Name,ProcessID, (Get-Process -Id ProcessID).name
```
## Sí funciona
* https://www.jesusninoc.com/10/11/mostrar-la-relacion-entre-servicios-y-procesos-con-powershell/

# Procesos y ruta de ejecución del proceso
* https://www.jesusninoc.com/11/29/ejercicios-de-powershell-procesos-y-ruta-de-ejecucion-del-proceso/

# Ejercicios de PowerShell: saber la ruta de los servicios que se están ejecutando
* https://www.jesusninoc.com/10/01/ejercicios-de-powershell-saber-la-ruta-de-los-servicios-que-se-estan-ejecutando/

# Ejercicios de PowerShell: de la lista de hilos que se están ejecutando indicar si alguno es un hilo de un proceso de un servicio
* https://www.jesusninoc.com/10/01/ejercicios-de-powershell-de-la-lista-de-hilos-que-se-estan-ejecutando-indicar-si-alguno-es-un-hilo-de-un-proceso-de-un-servicio/

# Ejercicios de PowerShell: de la lista de procesos que se están ejecutando indicar si alguno es un proceso de un servicio
* https://www.jesusninoc.com/10/01/ejercicios-de-powershell-de-la-lista-de-procesos-que-se-estan-ejecutando-indicar-si-alguno-es-un-proceso-de-un-servicio/

# Ejercicios de PowerShell: de los servicios que se están ejecutando indicar el nombre del proceso
* https://www.jesusninoc.com/10/01/ejercicios-de-powershell-de-los-servicios-que-se-estan-ejecutando-indicar-el-nombre-del-proceso/

# Ejercicios de PowerShell: mostrar el padre de un hilo
* https://www.jesusninoc.com/09/29/ejercicios-de-powershell-mostrar-el-padre-de-un-hilo/
