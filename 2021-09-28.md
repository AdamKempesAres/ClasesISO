# Instalación de software libre y propietario

- Funciones de un sistema operativo.
  - Controlar y gestionar el uso del hardware del ordenador: CPU, dispositivos de E/S, Memoria principal, tarjetas gráficas y el resto de periféricos.
  - Administrar la ejecución de los procesos. Planificación.
  - Controlar el proceso de organización de la información. Creación, acceso (ubicación física) y borrado de archivos.
  - Controlar el acceso de los programas o los usuarios a los recursos del sistema.
  - Proporcionar interfaces de usuario: en modo texto y gráficos.
  - Servicios soporte: actualizaciones de software, controladores para nuevos periféricos, etc.

# Creación y destrucción de procesos
## Creación de procesos (apartado Crear procesos)
https://www.jesusninoc.com/2017/07/07/7-gestion-de-procesos-en-powershell/
## Destrucción de procesos (apartado Matar procesos)
https://www.jesusninoc.com/2017/07/07/7-gestion-de-procesos-en-powershell/

# Más información sobre procesos
https://www.jesusninoc.com/2017/07/07/7-gestion-de-procesos-en-powershell/

--------------------

# Ejercicio con Base64
## Ejercicio resuelto de CREAR TABLA DE BASE64
https://www.jesusninoc.com/2017/02/11/tabla-de-caracteres-base64/

## EJECUTAR UN START-PROCESS (CREAR UN PROCESO)
```PowerShell
Start-Process -FilePath powershell.exe -ArgumentList '-encodedcommand RwBlAHQALQBQAHIAbwBjAGUAcwBzAA=='
```

## Ejecutar un cmdlet codificado en Base64
https://www.jesusninoc.com/2016/09/24/ejecutar-un-cmdlet-convertido-en-base64/

# Para repasar
- https://github.com/jesnino/PowerShell
- https://github.com/jesnino/PowerShell/tree/master/Repaso
- https://www.jesusninoc.com/2017/07/07/7-gestion-de-procesos-en-powershell/

----------
----------

# Instalación de software libre y propietario

- Funciones de un sistema operativo.
  - Controlar y gestionar el uso del hardware del ordenador: CPU, dispositivos de E/S, Memoria principal, tarjetas gráficas y el resto de periféricos.
  - Administrar la ejecución de los procesos. Planificación.
  - Controlar el proceso de organización de la información. Creación, acceso (ubicación física) y borrado de archivos.
  - Controlar el acceso de los programas o los usuarios a los recursos del sistema.
  - Proporcionar interfaces de usuario: en modo texto y gráficos.
  - Servicios soporte: actualizaciones de software, controladores para nuevos periféricos, etc.

--------------------

# Ejercicios PowerShell hilos y procesos

```PowerShell
Get-Process | select *
Get-Process | select Threads
Get-Process | select Threads | Format-Custom
(Get-Process | select Threads).count
Get-WmiObject -Class Win32_Thread
Get-WmiObject -Class Win32_Thread  | Format-Table -Property priority, thread*, User*Time, kernel*Time 
(Get-WmiObject -Class Win32_Thread).count
(Get-WmiObject -Class Win32_Thread  | Format-Table -Property priority, thread*, User*Time, kernel*Time).count
```

```PowerShell
Get-WmiObject -Class Win32_Thread
Get-WmiObject -Class Win32_Process
```

```PowerShell
Get-Process | select id,threads
Get-WmiObject win32_process | Select-Object ParentProcessId,ProcessId
```

```PowerShell
Get-Process | select Name,Threads | Out-GridView

(Get-WmiObject -Class Win32_Thread  | Format-Table -Property priority, thread*, User*Time, kernel*Time ).count
(Get-WmiObject -Class Win32_Thread).count

Get-WmiObject -Class Win32_Thread | select id,priority
Get-WmiObject -Class Win32_Process

Get-WmiObject win32_process | Select-Object ParentProcessId,ProcessId

#Process that created the thread
Get-WmiObject -Class Win32_Thread | select handle,ProcessHandle

(Get-WmiObject win32_process) | Select-Object Name,CommandLine | Format-Custom
```

## Obtener el nombre de un proceso y sus hilos
```PowerShell
foreach($proceso in Get-Process)
{
    $proceso.Name
    $proceso.Threads.Count
    Start-Sleep -Seconds 5
}
```

## Obtener el identificador del hilo junto con el nombre del proceso que lo creó
```PowerShell
foreach($hilo in (Get-WmiObject -Class Win32_Thread | select Handle,ProcessHandle))
{
    "identificador hilo: "+ $hilo.Handle
    "identificador proceso que crea hilo: "+ $hilo.ProcessHandle
    "nombre de proceso crea hilo: "+ (Get-Process -id $hilo.ProcessHandle).name
}
```
